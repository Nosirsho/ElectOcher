@{
    ViewData["Title"] = "Home Page";
}

    <div class="text-center mt-5">
        <a class="nav-link" href="/Operator">Электромобили</a>
        <form method="post">
            <input type="submit" value="Отправить" id="submitForm" />
        </form>

        <div id="notify"></div>

    </div>

        <script src="js/signalr/dist/browser/signalr.min.js"></script>
        <script>
            const hubConnection = new signalR.HubConnectionBuilder()
                .withUrl("/chat")
                .build();
            let connectionId = "";
            document.getElementById("submitForm")
                .addEventListener("click", function (e) {
                    e.preventDefault();

                    const data = new FormData();
                    data.append("connectionId", connectionId);

                    fetch("home/create", {
                        method: "POST",
                        body: data
                    })
                        .catch(error => console.error("Error: ", error));
                });
            // получение сообщения от сервера
            hubConnection.on("Notify", function (message) {

                // создает элемент <p> для сообщения пользователя
                let elem = document.createElement("p");
                elem.appendChild(document.createTextNode(message));

                document.getElementById("notify").appendChild(elem);

            });
            hubConnection.start().then(() => {
                // после соединения получаем id подключения
                console.log(hubConnection.connectionId);
                connectionId = hubConnection.connectionId;
            });
        </script>

